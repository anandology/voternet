$def with (place)

$var title: $place.name

<h1>$place.name <span class="small">$place.type_label</span></h1>

<h2>Volunteers</h2>

$if not place.volunteers:
    <em>None found.</em>
$else:
    <table class="table">
        $for person in place.volunteers:
            <tr><td>$loop.index</td><td>$person.name</td><td>$person.email</td><td>$person.phone</td></tr>
    </table>

<div>
<br/>
<a href="$place.get_url()/add-people">Add volunteers?</a>
</div>

<h2>Graphs</h2>

$if place.subtype:
    <h2>$plural(place.subtype_label) <a href="$place.get_url()/edit"><span class="small">edit</span></a></h2>
    <table class="table table-striped">
        $ subtypes = place.get_all_subtypes()[1:]
        <tr>
            <th>Name</th>
            $for t in subtypes:
                <th>$t.code</th>
        <tr> 
        $for p in place.get_places():
            <tr>                
                <td><a href="$p.get_url()">$p.name</a></td>
                $ counts = p.get_counts()
                $for t in subtypes:
                    <th>$counts.get(t.code, 0)</th>
            </tr>
    </table>